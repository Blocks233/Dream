【数学泛刷】



1.http://codeforces.com/problemset/problem/145/D

注：复杂的计数结构题，所谓计数结构是这样一种机制，保证可以不重复不遗漏的计数对象

枚举左边区间的右端点，步进其左端点，遇到新的未出现的关键点，去右边区间更新"不交线段并"，维护右边区间的非法数目，容斥原理



2.http://codeforces.com/contest/145/problem/D

注：简单枚举+容斥+线段判交，整点线段上整点个数公式：gcd(|x1-x2|,|y1-y2|)+1



3.http://codeforces.com/problemset/problem/286/E

注：思维题+背包+闭包/线性空间+fft



4.http://codeforces.com/problemset/problem/662/C

注：比较隐蔽的异或卷积模型，已知隐蔽的函数f(x)=x的二进制表示中0和1的个数最小值

求

$$
min \sum_if(a_i \oplus x), x \in [0,2^n) \\

denote: A_i=f(i),B_i=count(i),or that:B_{a_i}++ \\

fwt:A \oplus B \\
$$



5.http://codeforces.com/problemset/problem/632/E

注：简单生成函数+多项式乘方，注意只需要知道最终结果每个系数是否为0，ntt双模数hash思想



6.http://codeforces.com/problemset/problem/827/E

注：求带?的01串的所有可能周期，等价于对周期t，任意i有：a[i]与a[i-kt]不矛盾，fft/ntt可用差卷积求a[i]与a[i-t]的矛盾性，数组ret[t]并上所有t倍数的矛盾性，即ret[kt]即可



7.http://codeforces.com/problemset/problem/715/E

注：考察卷积的组合意义，fft/ntt+容斥/二项式反演+第一类斯特林数





8.http://codeforces.com/problemset/problem/755/G

注：特征根法解行生成函数的递推方程+多项式基本操作(求逆，乘方，开方等)

做法1：

$$
f[i][j]=f[i-1][j]+f[i-1][j-1]+f[i-2][j-1] \\ 

那么 f[n] 作为行生成函数满足： \\

\begin{array}{l}{f_{n}(x)=f_{n-1}(x)+x f_{n-1}(x)+x f_{n-2}(x)} \\ {=(x+1) f_{n-1}(x)+x f_{n-2}(x)}\end{array}\\

f_{i}=C_{1} * T 1(x)^{i}+C_{2} * T_{2}(x)^{i}\\

T1和T2为以下特征根方程的两根：\\

T^{2}(x) - (x+1)T(x) - x = 0\\

\triangle=x^2+6x+1\\

T_{1}(x)=\frac{1+x+\sqrt\triangle}{2}\\

T_{2}(x)=\frac{1+x-\sqrt\triangle}{2}\\

已知:\\

f_0=C_1+C_2=1\\

f_1=C_1*T_1+C_2*T_2=1+x\\

故：\\

C_1=\frac{T_2-(1+x)}{T_2-T_1}\\

C_2=\frac{T_1-(1+x)}{T_1-T_2}\\

注意到，由韦达定理：\\

T_1+T_2=-\frac{b}{a}=1+x\\

T_2-T_1=\sqrt\triangle\\

故：\\

C_1=\frac{T_1}{\sqrt\triangle}\\

C_2=-\frac{T_2}{\sqrt\triangle}\\

则：\\

\large f_n=\frac{T_1^{n+1}-T_2^{n+1}}{\sqrt\triangle}\\

由于：T_2常数项为0，故T_2^{n+1}最低次超过n\\

故：只需计算f_n=\frac{T_1^{n+1}}{\sqrt\triangle}\\
$$


